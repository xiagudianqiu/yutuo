<!DOCTYPE html>
<html lang="zh-CN">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>屿拓定制服务 - 载入中</title>
    <!-- 预加载LOGO图片 -->
    <link rel="preload" href="yutuo.gif" as="image">
    <!-- 添加Three.js库 -->
    <script src="https://cdn.jsdelivr.net/npm/three@0.149.0/build/three.min.js"></script>
    <!-- 内联关键CSS，避免外部CSS文件的加载阻塞 -->
    <style>
        :root {
            --color1: #3A29FF;
            --color2: #FF94B4;
            --color3: #FF3232;
        }
        
        body, html {
            margin: 0;
            padding: 0;
            height: 100%;
            width: 100%;
            overflow: hidden;
            background-color: #000;
            font-family: 'Arial', sans-serif;
        }
        
        /* 主要容器 */
        .aurora-container {
            position: relative;
            width: 100%;
            height: 100vh;
            overflow: hidden;
            background-color: #000;
            z-index: 1;
        }
        
        /* 备用背景 - 改善过渡效果 */
        .fallback-bg {
            position: absolute;
            top: 0;
            left: 0;
            width: 100%;
            height: 100%;
            background: linear-gradient(135deg, var(--color1), var(--color2), var(--color3));
            background-size: 200% 200%;
            animation: gradientMove 15s ease infinite;
            opacity: 1;
            transition: opacity 2s ease-in-out;
            z-index: 1;
        }
        
        @keyframes gradientMove {
            0% { background-position: 0% 50%; }
            50% { background-position: 100% 50%; }
            100% { background-position: 0% 50%; }
        }
        
        /* Canvas样式 */
        canvas {
            position: absolute;
            top: 0;
            left: 0;
            width: 100%;
            height: 100%;
            z-index: 2;
            opacity: 0;
            transition: opacity 2.5s ease-in-out;
        }
        
        /* 淡入动画 */
        .fade-in {
            animation: fadeIn 2.5s ease-in-out forwards;
        }
        
        @keyframes fadeIn {
            from { opacity: 0; }
            to { opacity: 1; }
        }
        
        /* 淡出动画 */
        .fade-out {
            animation: fadeOut 2s ease-in-out forwards;
        }
        
        @keyframes fadeOut {
            from { opacity: 1; }
            to { opacity: 0; }
        }
        
        /* 页面过渡容器 */
        .page-transition {
            position: fixed;
            top: 0;
            left: 0;
            width: 100%;
            height: 100%;
            background-color: #000;
            z-index: 9999;
            opacity: 0;
            pointer-events: none;
            transition: opacity 1.5s ease-in-out;
        }
        
        .page-transition.active {
            opacity: 1;
            pointer-events: all;
        }
        
        .logo-container {
            position: absolute;
            top: 50%;
            left: 50%;
            transform: translate(-50%, -50%);
            z-index: 10;
            opacity: 0;
            transition: opacity 1.5s ease;
            text-align: center;
        }
        
        .logo {
            width: 200px;
            height: 200px;
            display: flex;
            align-items: center;
            justify-content: center;
            margin: 0 auto;
        }
        
        .logo img {
            max-width: 100%;
            height: auto;
            opacity: 0;
            transition: opacity 0.5s ease;
        }
        
        .loading-text {
            color: #fff;
            font-family: Arial, sans-serif;
            text-align: center;
            margin-top: 20px;
            font-size: 16px;
            letter-spacing: 1px;
        }
        
        .loading-bar {
            width: 200px;
            height: 4px;
            background-color: rgba(255, 255, 255, 0.2);
            margin: 10px auto;
            border-radius: 2px;
            overflow: hidden;
        }
        
        .loading-progress {
            height: 100%;
            width: 0%;
            background-color: #FFDF00;
            transition: width 0.5s ease;
        }
        
        /* 调整移动设备显示 */
        @media (max-width: 768px) {
            .logo-container {
                top: 40%;
            }
        }
    </style>
</head>
<body>
    <div class="aurora-container">
        <!-- 添加备用背景，在Canvas加载前显示 -->
        <div class="fallback-bg"></div>
        
        <!-- 中心Logo -->
        <div class="logo-container">
            <div class="logo">
                <img src="yutuo.gif" alt="屿拓移门" id="logoImage" onload="this.style.opacity=1;">
            </div>
            <div class="loading-text">载入中...</div>
            <div class="loading-bar">
                <div class="loading-progress" id="progress"></div>
            </div>
        </div>
    </div>
    
    <!-- 添加页面过渡元素 -->
    <div class="page-transition" id="page-transition"></div>
    
    <script>
        // 设置超时自动跳转，确保不会卡在加载页面
        const timeout = setTimeout(() => {
            navigateWithTransition();
        }, 10000);
        
        // 页面加载函数
        document.addEventListener('DOMContentLoaded', function() {
            const container = document.querySelector('.aurora-container');
            const fallbackBg = document.querySelector('.fallback-bg');
            const logoContainer = document.querySelector('.logo-container');
            const logoImage = document.getElementById('logoImage');
            
            // 显示logo容器
            setTimeout(() => {
                logoContainer.style.opacity = '1';
            }, 300);
            
            // 开始加载进度条
            simulateLoading();
            
            // 尝试初始化Three.js动画
            try {
                initThreeJsAurora();
            } catch (error) {
                console.error('初始化Three.js动画失败:', error);
                // 确保即使动画失败也能继续加载
            }
        });
        
        // 带过渡效果的页面导航
        function navigateWithTransition() {
            const transition = document.getElementById('page-transition');
            const aurora = document.querySelector('.aurora-container');
            
            // 激活过渡层
            transition.classList.add('active');
            
            // 添加淡出效果到当前内容
            aurora.classList.add('fade-out');
            
            // 延迟后跳转到首页
            setTimeout(() => {
                window.location.href = 'shouye.html';
            }, 1800);
        }
        
        // 模拟加载进度
        function simulateLoading() {
            const progress = document.getElementById('progress');
            let width = 0;
            
            // 更慢速的加载 - 每60ms增加1.5%
            const interval = setInterval(() => {
                if (width >= 100) {
                    clearInterval(interval);
                    clearTimeout(timeout);
                    setTimeout(() => {
                        navigateWithTransition();
                    }, 1000);
                } else {
                    width += 1.5;
                    progress.style.width = width + '%';
                }
            }, 60);
        }
        
        // Three.js极光动画初始化
        function initThreeJsAurora() {
            const container = document.querySelector('.aurora-container');
            const fallbackBg = document.querySelector('.fallback-bg');
            
            // 创建并配置Canvas
            const canvas = document.createElement('canvas');
            container.insertBefore(canvas, container.firstChild.nextSibling);
            
            // Three.js初始化
            const scene = new THREE.Scene();
            const camera = new THREE.PerspectiveCamera(75, window.innerWidth / window.innerHeight, 0.1, 1000);
            camera.position.z = 5;
            
            // 创建renderer
            const renderer = new THREE.WebGLRenderer({ 
                canvas: canvas,
                antialias: true,
                alpha: true
            });
            renderer.setSize(window.innerWidth, window.innerHeight);
            renderer.setPixelRatio(Math.min(window.devicePixelRatio, 2)); // 限制像素比，提高性能
            
            // 创建极光效果
            const geometry = new THREE.PlaneGeometry(20, 10, 50, 50); // 减少细分，提高性能
            
            // 使用片段着色器创建极光效果
            const material = new THREE.ShaderMaterial({
                uniforms: {
                    time: { value: 0 },
                    color1: { value: new THREE.Color("#3A29FF") },
                    color2: { value: new THREE.Color("#FF94B4") },
                    color3: { value: new THREE.Color("#FF3232") }
                },
                vertexShader: `
                    varying vec2 vUv;
                    uniform float time;
                    
                    void main() {
                        vUv = uv;
                        vec3 pos = position;
                        float displacement = sin(pos.x * 0.3 + time) * sin(pos.y * 0.2 + time) * 0.3;
                        pos.z += displacement;
                        gl_Position = projectionMatrix * modelViewMatrix * vec4(pos, 1.0);
                    }
                `,
                fragmentShader: `
                    varying vec2 vUv;
                    uniform float time;
                    uniform vec3 color1;
                    uniform vec3 color2;
                    uniform vec3 color3;
                    
                    void main() {
                        float noise = sin(vUv.x * 5.0 + time) * sin(vUv.y * 5.0 + time * 0.3);
                        vec3 color = mix(color1, color2, vUv.y + noise * 0.1);
                        color = mix(color, color3, sin(vUv.x * 3.14159 + time * 0.2) * 0.5 + 0.5);
                        
                        // 添加基于距离的透明度，边缘透明
                        float distToCenter = length(vUv - vec2(0.5));
                        float alpha = smoothstep(0.8, 0.4, distToCenter);
                        
                        gl_FragColor = vec4(color, alpha * 0.7); // 降低整体透明度
                    }
                `,
                transparent: true,
                side: THREE.DoubleSide
            });
            
            const mesh = new THREE.Mesh(geometry, material);
            scene.add(mesh);
            
            // 动画循环
            let animationStarted = false;
            const animate = () => {
                requestAnimationFrame(animate);
                // 降低动画速度
                material.uniforms.time.value += 0.01;
                mesh.rotation.x = Math.sin(material.uniforms.time.value * 0.03) * 0.1;
                mesh.rotation.y = Math.sin(material.uniforms.time.value * 0.02) * 0.1;
                renderer.render(scene, camera);
            };
            
            // 启动动画
            animate();
            
            // 添加淡入效果和隐藏备用背景
            let startTime = null;
            
            function fadeInCanvas(timestamp) {
                if (!startTime) startTime = timestamp;
                const elapsed = timestamp - startTime;
                
                if (elapsed > 500 && !animationStarted) {
                    canvas.classList.add('fade-in');
                    animationStarted = true;
                }
                
                if (elapsed > 1300) {
                    fallbackBg.style.opacity = "0";
                } else {
                    requestAnimationFrame(fadeInCanvas);
                }
            }
            
            requestAnimationFrame(fadeInCanvas);
            
            // 自适应窗口大小
            window.addEventListener('resize', () => {
                const width = window.innerWidth;
                const height = window.innerHeight;
                
                camera.aspect = width / height;
                camera.updateProjectionMatrix();
                renderer.setSize(width, height);
                renderer.setPixelRatio(Math.min(window.devicePixelRatio, 2));
            });
        }
    </script>
</body>
</html> 